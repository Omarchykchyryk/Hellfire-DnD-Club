<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Таблица из Google Sheets</title>
</head>
<body>

<div id="table">Загрузка...</div>

<script>
async function loadTable() {
    const url = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTtRpwz0K4XzMujJbHQm7BkiseYA8Id2qIw6jGVsU-VeXGhJQXib0ThjY4WP3FEh3H2z2o9OgkVGRbQ/pub?output=csv";

    try {
        const response = await fetch(url);
        if (!response.ok) throw new Error("Fetch failed");

        const text = await response.text();
        const rows = text.trim().split("\n").map(r => r.split(","));

        let html = "<table border='1' cellspacing='0' cellpadding='4'>";
        rows.forEach(row => {
            html += "<tr>";
            row.forEach(cell => {
                html += `<td>${cell}</td>`;
            });
            html += "</tr>";
        });
        html += "</table>";

        document.getElementById("table").innerHTML = html;
    } catch (e) {
        document.getElementById("table").innerHTML = "Ошибка загрузки данных";
        console.log(e);
    }
}

loadTable();
setInterval(loadTable, 5000);
</script>

</body>
</html>
